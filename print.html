<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>selene Documentation</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded "><a href="selene.html"><strong aria-hidden="true">1.</strong> selene</a></li><li class="expanded "><a href="motivation.html"><strong aria-hidden="true">2.</strong> Motivation</a></li><li class="expanded "><a href="luacheck.html"><strong aria-hidden="true">3.</strong> Luacheck Comparison</a></li><li class="expanded "><a href="cli/index.html"><strong aria-hidden="true">4.</strong> Command Line Interface</a></li><li><ol class="section"><li class="expanded "><a href="cli/installation.html"><strong aria-hidden="true">4.1.</strong> Installation</a></li><li class="expanded "><a href="cli/usage.html"><strong aria-hidden="true">4.2.</strong> Usage</a></li><li class="expanded "><a href="cli/configuration.html"><strong aria-hidden="true">4.3.</strong> Configuration</a></li><li class="expanded "><a href="cli/std.html"><strong aria-hidden="true">4.4.</strong> Standard Library Format</a></li></ol></li><li class="expanded "><a href="contributing.html"><strong aria-hidden="true">5.</strong> Contributing</a></li><li class="expanded "><a href="lints/index.html"><strong aria-hidden="true">6.</strong> Lints</a></li><li><ol class="section"><li class="expanded "><a href="lints/almost_swapped.html"><strong aria-hidden="true">6.1.</strong> almost_swapped</a></li><li class="expanded "><a href="lints/divide_by_zero.html"><strong aria-hidden="true">6.2.</strong> divide_by_zero</a></li><li class="expanded "><a href="lints/empty_if.html"><strong aria-hidden="true">6.3.</strong> empty_if</a></li><li class="expanded "><a href="lints/global_usage.html"><strong aria-hidden="true">6.4.</strong> global_usage</a></li><li class="expanded "><a href="lints/if_same_then_else.html"><strong aria-hidden="true">6.5.</strong> if_same_then_else</a></li><li class="expanded "><a href="lints/ifs_same_cond.html"><strong aria-hidden="true">6.6.</strong> ifs_same_cond</a></li><li class="expanded "><a href="lints/multiple_statements.html"><strong aria-hidden="true">6.7.</strong> multiple_statements</a></li><li class="expanded "><a href="lints/parenthese_conditions.html"><strong aria-hidden="true">6.8.</strong> parenthese_conditions</a></li><li class="expanded "><a href="lints/shadowing.html"><strong aria-hidden="true">6.9.</strong> shadowing</a></li><li class="expanded "><a href="lints/standard_library.html"><strong aria-hidden="true">6.10.</strong> standard_library</a></li><li class="expanded "><a href="lints/suspicious_reverse_loop.html"><strong aria-hidden="true">6.11.</strong> suspicious_reverse_loop</a></li><li class="expanded "><a href="lints/unbalanced_assignments.html"><strong aria-hidden="true">6.12.</strong> unbalanced_assignments</a></li><li class="expanded "><a href="lints/undefined_variable.html"><strong aria-hidden="true">6.13.</strong> undefined_variable</a></li><li class="expanded "><a href="lints/unused_variable.html"><strong aria-hidden="true">6.14.</strong> unused_variable</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">selene Documentation</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#selene" id="selene">selene</a></h1>
<p><strong>selene</strong> is a command line tool designed to help write correct and idiomatic Lua code.</p>
<ul>
<li><strong>New to selene?</strong> Read the <a href="./motivation.html">motivation behind its creation</a> and the <a href="./cli/index.html">CLI guide</a>. If you already use <a href="https://luacheck.readthedocs.io/en/stable/">Luacheck</a>, you can read the <a href="./luacheck.html">Luacheck comparison and migration guide</a>.</li>
<li><strong>Existing user?</strong> Read the <a href="https://github.com/Kampfkarren/selene/blob/master/CHANGELOG.md">changelog</a> to learn about any new features or bug fixes.</li>
<li><strong>Interested in what selene lints for?</strong> Read the <a href="./lints/index.html">list of lints</a>.</li>
<li><strong>Interested in contributing to selene's codebase?</strong> Read the <a href="./contributing.html">contribution guide</a>.</li>
<li><strong>Want to discuss selene or get help?</strong> Join the <a href="https://discord.gg/mhtGUS8">Roblox OS Community Discord</a>. Note: selene is not Roblox exclusive, but it started its life for Roblox development.</li>
</ul>
<h3><a class="header" href="#license" id="license">License</a></h3>
<p>selene and all its source code are licensed under the <a href="https://www.mozilla.org/MPL/2.0/">Mozilla Public License 2.0</a>.</p>
<h1><a class="header" href="#motivation" id="motivation">Motivation</a></h1>
<h3><a class="header" href="#because-bugs" id="because-bugs">Because bugs</a></h3>
<p>When writing any code, it's very easy to make silly mistakes that end up introducing bugs. A lot of the time, these bugs are hard to track down and debug, and sometimes are even harder to replicate.</p>
<p>This risk is made ever more real because of the generally lax nature of Lua. Incorrect code is regularly passed off and isn't noticed until something breaks at runtime. Sometimes you'll get a clear error message, and will have to spend time going back, fixing the code, and making sure you actually fixed it. Other times, the effects are more hidden, and instead of getting an error your code will just pass through along, in an incorrect state.</p>
<p>Take, for example, this code:</p>
<pre><code class="language-lua">function Player:SwapWeapons()
    self.CurrentWeapon = self.SideWeapon
    self.SideWeapon = self.CurrentWeapon
end
</code></pre>
<p>This is code that is technically correct, but is absolutely not what you wanted to write. However, because it is <em>technically</em> correct, Lua will do exactly what you tell it to do, and so...</p>
<ul>
<li>Player wants to swap their weapons</li>
<li>Your code calls <code>player:SwapWeapons()</code></li>
<li>Their current weapon is set to their side weapon...</li>
<li>...but their side weapon is set to their current weapon afterwards, which is what they just equipped!</li>
</ul>
<p>Uh oh! After debugging this, you realize that you actually meant to write was...</p>
<pre><code class="language-lua">function Player:SwapWeapons()
    self.CurrentWeapon, self.SideWeapon = self.SideWeapon, self.CurrentWeapon
end
</code></pre>
<p>If you were using selene, you would've been alerted right away that your original code looked like an <a href="../lints/almost_swapped.html"><code>almost_swapped</code></a>.</p>
<pre><code>error[almost_swapped]: this looks like you are trying to swap `self.CurrentWeapon` and `self.SideWeapon`

   ┌── fail.lua:4:5 ───
   │
 4 │ ╭     self.CurrentWeapon = self.SideWeapon
 5 │ │     self.SideWeapon = self.CurrentWeapon
   │ ╰────────────────────────────────────────^
   │
   = try: `self.CurrentWeapon, self.SideWeapon = self.SideWeapon, self.CurrentWeapon`
</code></pre>
<p>Other bugs arise because of Lua's lack of typing. While it can feel freeing to developers to not have to specify types everywhere, it makes it easier to mess up and write broken code. For example, take the following code:</p>
<pre><code class="language-lua">for _, shop in pairs(GoldShop, ItemShop, MedicineShop) do
</code></pre>
<p>This code is yet again technically correct, but not what we wanted to do. <code>pairs</code> will take the first argument, <code>GoldShop</code>, and ignore the rest. Worse, the <code>shop</code> variable will now be the values of the contents of <code>GoldShop</code>, not the shop itself. This can cause massive headaches, since although you're likely to get an error later down the line, it's more likely it'll be in the vein of &quot;attempt to index a nil value <code>items</code>&quot; than something more helpful. If you used <code>ipairs</code> instead of <code>pairs</code>, your code inside might just not run, and won't produce an error at all.</p>
<p>Yet again, selene saves us.</p>
<pre><code>error[incorrect_standard_library_use]: standard library function `pairs` requires 1 parameters, 3 passed

   ┌── fail.lua:1:16 ───
   │
 1 │ for _, shop in pairs(GoldShop, ItemShop, MedicineShop) do
   │                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   │
</code></pre>
<p>This clues the developer into writing the code they meant to write:</p>
<pre><code class="language-lua">for _, shop in pairs({ GoldShop, ItemShop, MedicineShop }) do
</code></pre>
<h3><a class="header" href="#because-idiomatic-lua" id="because-idiomatic-lua">Because idiomatic Lua</a></h3>
<p>While it's nice to write code however you want to, issues can arise when you are working with other people, or plan on open sourcing your work for others to contribute to. It's best for everyone involved if they stuck to the same way of writing Lua.</p>
<p>Consider this contrived example:</p>
<pre><code class="language-lua">call(1 / 0)
</code></pre>
<p>The person who wrote this code might have known that <code>1 / 0</code> evaluates to <code>math.huge</code>. However, anyone working on that code will likely see it and spend some time figuring out why they wrote the code that way.</p>
<p>If the developer was using selene, this code would be denied:</p>
<pre><code>warning[divide_by_zero]: dividing by zero is not allowed, use math.huge instead

   ┌── fail.lua:1:6 ───
   │
 1 │ call(1 / 0)
   │      ^^^^^
   │
</code></pre>
<p>Furthermore, selene is meant to be easy for developers to add their own lints to. You could create your own lints for your team to prevent behavior that is non-idiomatic to the codebase. For example, let's say you're working on a <a href="https://developer.roblox.com/en-us">Roblox</a> codebase, and you don't want your developers using the data storage methods directly. You could create your own lint so that this code:</p>
<pre><code class="language-lua">local DataStoreService = game:GetService(&quot;DataStoreService&quot;)
</code></pre>
<p>...creates a warning, discouraging its use. For more information on how to create your own lints, check out the <a href="../contributing.html">contribution guide</a>.</p>
<h1><a class="header" href="#luacheck-comparison" id="luacheck-comparison">Luacheck Comparison</a></h1>
<h2><a class="header" href="#selene-vs-luacheck" id="selene-vs-luacheck">selene vs. luacheck</a></h2>
<p>selene is not the first Lua linter. The main inspiration behind selene is <a href="https://luacheck.readthedocs.io/en/stable/">luacheck</a>. However, the two have very little in common besides inception.</p>
<ul>
<li>selene is actively maintained, while at the time of writing luacheck's last commit was in October 2018.</li>
<li>selene is written in Rust, while luacheck is written in Lua. In practice, this means that selene is much faster than luacheck while also being able to easily take advantage of features luacheck cannot because of the difficulty of using depenedencies in Lua.</li>
<li>selene is multithreaded, again leading to significantly better performance.</li>
<li>selene has rich output, while luacheck has basic output.</li>
</ul>
<p>selene:</p>
<pre><code>error[suspicious_reverse_loop]: this loop will only ever run once at most

   ┌── fail.lua:1:9 ───
   │
 1 │ for _ = #x, 1 do
   │         ^^^^^
   │
   = help: try adding `, -1` after `1`
</code></pre>
<p>luacheck:</p>
<pre><code>Checking fail.lua                                 2 warnings

    fail.lua:1:1: numeric for loop goes from #(expr) down to 1 but loop step is not negative
</code></pre>
<ul>
<li>selene uses <a href="https://github.com/toml-lang/toml">TOML</a> files for configuration, while luacheck uses <code>.luacheckrc</code>, which runs Lua.</li>
<li>selene allows for <a href="./cli/std.html">standard library configuration</a> such as argument types, argument counts, etc, while luacheck only allows knowing that fields exist and can be written to. In practice, this means that selene catches:</li>
</ul>
<pre><code class="language-lua">for _, shop in pairs(GoldShop, ItemShop, MedicineShop) do

math.pi()
</code></pre>
<p>...while luacheck does not.</p>
<ul>
<li>selene has English names for lints instead of arbitrary numbers. In luacheck, you ignore &quot;<a href="https://luacheck.readthedocs.io/en/stable/warnings.html#unbalanced-assignments"><code>211</code></a>&quot;, while in selene you ignore &quot;<a href="./lints/unbalanced_assignments.html"><code>unbalanced_assignments</code></a>&quot;.</li>
<li>selene has distinctions for &quot;deny&quot; and &quot;warn&quot;, while every luacheck lint is the same.</li>
<li>selene has a much simpler codebase, and is much easier to add your own lints to.</li>
<li>selene has optional support and large focus specifically for Roblox development.</li>
<li>selene will only show you files that lint, luacheck only does this with the <code>-q</code> option (quiet).</li>
<li>selene has <a href="./lints/index.html">significantly more lints</a>.</li>
</ul>
<p>This is not to say selene is objectively better than luacheck, at least not yet.</p>
<ul>
<li>luacheck has lints for long lines and whitespace issues, selene does not as it is unclear whether style issues like these are fit for a linter or better under the scope of a Lua beautifier.</li>
<li>luacheck officially supports versions past Lua 5.1, selene does not yet as there is not much demand.</li>
<li>luacheck supports the following lints that selene does not yet:
<ul>
<li>Unreachable code</li>
<li>Unused labels (selene does not officially support Lua 5.2 yet)</li>
<li>Detecting variables that are only ever mutated, but not read</li>
<li>Using uninitialized variables</li>
</ul>
</li>
</ul>
<p>If you would like to contribute these lints, please submit a pull request!</p>
<ul>
<li>luacheck supports <code>-- luacheck: ignore</code> for ignoring specific lines, while selene does not. This is something that will eventually be fixed when this design is evaluted.</li>
<li>luacheck is supported by editor extensions, while selene does not. <a href="https://github.com/Kampfkarren/selene/issues/22">This is something that will eventually be fixed.</a></li>
</ul>
<h2><a class="header" href="#migration" id="migration">Migration</a></h2>
<p>luacheck does not require much configuration to begin with, so migration should be easy.</p>
<ul>
<li>You can configure what lints are allowed in the <a href="./cli/configuration.html#changing-the-severity-of-lints">configuration</a>.</li>
<li>Do you have a custom standard library (custom globals, functions, etc)? Read the <a href="./cli/std.html">standard library guide</a>.
<ul>
<li>Are you a Roblox developer using something like <a href="https://github.com/Quenty/luacheck-roblox/">luacheck-roblox</a>? A featureful standard library for Roblox is generated with every commit on GitHub. TODO: Have a flag in the selene CLI to generate a Roblox standard library a la <code>generate-roblox-std</code>? Should <code>generate-roblox-std</code> be uploaded to crates.io?</li>
</ul>
</li>
</ul>
<h1><a class="header" href="#command-line-interface" id="command-line-interface">Command Line Interface</a></h1>
<p><strong>selene</strong> is mostly intended for use as a command line tool.</p>
<p>In this section, you will learn how to use selene in this manner.</p>
<h1><a class="header" href="#installation" id="installation">Installation</a></h1>
<p><strong>selene</strong> is written in Rust, and the recommended installation method is through the <a href="https://doc.rust-lang.org/cargo/">Cargo package manager</a>.</p>
<p>To use Cargo, you must first install Rust. <a href="https://rustup.rs/">rustup.rs</a> is a tool that makes this very easy.</p>
<p>Once you have Rust installed, use either command:</p>
<p><strong>If you want the most stable version of selene</strong></p>
<pre><code>cargo install selene
</code></pre>
<p>(Note: Currently, the above method will give you an outdated selene, as the selene crate on Cargo is not yet maintained.)</p>
<p><strong>If you want the most up to date version of selene</strong></p>
<pre><code>cargo install --bin selene --git https://github.com/Kampfkarren/selene
</code></pre>
<h3><a class="header" href="#roblox-developers" id="roblox-developers">Roblox developers</a></h3>
<p>selene is built without Roblox specific lints by default. If you want these, type <code>--features roblox</code> after whichever command you choose.</p>
<h1><a class="header" href="#cli-usage" id="cli-usage">CLI Usage</a></h1>
<p>If you want to get a quick understanding of the interface, simply type <code>selene --help</code>.</p>
<pre><code>USAGE:
    selene [FLAGS] [OPTIONS] &lt;files&gt;...

FLAGS:
    -h, --help       Prints help information
    -q               Display only the necessary information
    -V, --version    Prints version information

OPTIONS:
        --config &lt;config&gt;              A toml file to configure the behavior of selene [default: selene.toml]
        --num-threads &lt;num-threads&gt;    Number of threads to run on, default to the numbers of logical cores on your
                                       system [default: 8]
        --pattern &lt;pattern&gt;            A glob to match files with to check [default: **/*.lua]

ARGS:
    &lt;files&gt;...
</code></pre>
<h2><a class="header" href="#basic-usage" id="basic-usage">Basic usage</a></h2>
<p>All unnamed inputs you give to selene will be treated as files to check for.</p>
<p>If you want to check a folder of files: <code>selene files</code></p>
<p>If you just want to check one file: <code>selene code.lua</code></p>
<p>If you want to check multiple files/folders: <code>selene file1 file2 file3 ...</code></p>
<h2><a class="header" href="#advanced-options" id="advanced-options">Advanced options</a></h2>
<p><strong>-q</strong></p>
<p><strong>--quiet</strong></p>
<p>Instead of the rich format, only necessary information will be displayed.</p>
<pre><code>~# selene code.lua
warning[divide_by_zero]: dividing by zero is not allowed, use math.huge instead

   ┌── code.lua:1:6 ───
   │
 1 │ call(1 / 0)
   │      ^^^^^
   │

Results:
0 errors
1 warnings
0 parse errors

~# selene code.lua -q
code.lua:1:6: warning[divide_by_zero]: dividing by zero is not allowed, use math.huge instead

Results:
0 errors
1 warnings
0 parse errors
</code></pre>
<p><strong>--num-threads</strong> <em>num-threads</em></p>
<p>Specifies the number of threads for selene to use. Defaults to however many cores your CPU has. If you type <code>selene --help</code>, you can see this number because it will show as the default for you.</p>
<p><strong>--pattern</strong> <em>pattern</em></p>
<p>A <a href="https://en.wikipedia.org/wiki/Glob_(programming)">glob</a> to match what files selene should check for. For example, if you only wanted to check files that end with <code>.spec.lua</code>, you would input <code>--pattern **/*.spec.lua</code>. Defaults to <code>**/*.lua</code>, meaning &quot;any lua file&quot;.</p>
<h1><a class="header" href="#configuration" id="configuration">Configuration</a></h1>
<p>selene is meant to be easily configurable. You can specify configurations for the entire project as well as for individual lints.</p>
<p>Configuration files are placed in the directory you are running selene in and are named <strong>selene.toml</strong>. As the name suggests, the configurations use the <a href="https://github.com/toml-lang/toml">Tom's Obvious, Minimal Language (TOML)</a> format. It is recommended you quickly brush up on the syntax, though it is very easy.</p>
<h2><a class="header" href="#changing-the-severity-of-lints" id="changing-the-severity-of-lints">Changing the severity of lints</a></h2>
<p>You can change the severity of lints by entering the following into selene.toml:</p>
<pre><code class="language-toml">[rules]
lint_1 = &quot;severity&quot;
lint_2 = &quot;severity&quot;
...
</code></pre>
<p>Where &quot;severity&quot; is one of the following:</p>
<ul>
<li><code>&quot;allow&quot;</code> - Don't check for this lint</li>
<li><code>&quot;warn&quot;</code> - Warn for this lint</li>
<li><code>&quot;deny&quot;</code> - Error for this lint</li>
</ul>
<p>Note that &quot;deny&quot; and &quot;warn&quot; are effectively the same, only warn will give orange text while error gives red text, and they both have different counters.</p>
<h2><a class="header" href="#configuring-specific-rules" id="configuring-specific-rules">Configuring specific rules</a></h2>
<p>You can configure specific rules by entering the following into selene.toml:</p>
<pre><code class="language-toml">[config]
rule1 = ...
rule2 = ...
...
</code></pre>
<p>Where the value is whatever the special configuration of that rule is. You can learn these on the lints specific page in the <a href="cli/../lints/index.html">list of lints</a>. For example, if we wanted to allow empty if branches if the contents contain comments, then we would write:</p>
<pre><code class="language-toml">[config]
empty_if = { comments_count = false }
</code></pre>
<h2><a class="header" href="#setting-the-standard-library" id="setting-the-standard-library">Setting the standard library</a></h2>
<p>Many lints use standard libraries for either verifying their correct usage or for knowing that variables exist where they otherwise wouldn't.</p>
<p>By default, selene uses Lua 5.1, though if we wanted to use the Lua 5.2 standard library, we would write:</p>
<pre><code class="language-toml">std = &quot;lua52&quot;
</code></pre>
<p>...at the top of selene.toml. You can learn more about the standard library format on the <a href="cli/./std.html">standard library guide</a>. The standard library given can either be one of the builtin ones (currently only <code>lua51</code> and <code>lua52</code>) or the filename of a standard library file in this format. For example, if we had a file named <code>special.toml</code>, we would write:</p>
<pre><code class="language-toml">std = &quot;special&quot;
</code></pre>
<h3><a class="header" href="#chaining-the-standard-library" id="chaining-the-standard-library">Chaining the standard library</a></h3>
<p>We can chain together multiple standard libraries by simply using a plus sign (<code>+</code>) in between the names.</p>
<p>For example, if we had <code>game.toml</code> and <code>engine.toml</code> standard libraries, we could chain them together like so:</p>
<pre><code class="language-toml">std = &quot;game+engine&quot;
</code></pre>
<h1><a class="header" href="#standard-library-format" id="standard-library-format">Standard Library Format</a></h1>
<p>selene provides a robust standard library format to allow for use with environments other than vanilla Lua. Standard libraries are defined in the form of <a href="https://github.com/toml-lang/toml">TOML</a> files.</p>
<h1><a class="header" href="#examples" id="examples">Examples</a></h1>
<p>For examples of the standard library format, see:</p>
<ul>
<li><a href="https://github.com/Kampfkarren/selene/blob/master/selene-lib/default_std/lua51.toml"><code>lua51.toml</code></a> - The default standard library for Lua 5.1</li>
<li><a href="https://github.com/Kampfkarren/selene/blob/master/selene-lib/default_std/lua52.toml"><code>lua52.toml</code></a> - A standard library for Lua 5.2's additions and removals. Reference this if your standard library is based off another (it most likely is).</li>
<li><a href="https://hastebin.com/exovojewax.toml"><code>roblox.toml</code></a> - A standard library for Roblox that incorporates all the advanced features of the format. If you are a Roblox developer, don't use this as anything other than reference--an up to date version of this library is available with every commit.</li>
</ul>
<h2><a class="header" href="#selene-1" id="selene-1">[selene]</a></h2>
<p>Anything under the key <code>[selene]</code> is used for meta information. The following paths are accepted:</p>
<p><code>[selene.base]</code> - Used for specifying what standard library to be based off of. Currently only accepts built in standard libraries, meaning <code>lua51</code> or <code>lua52</code>.</p>
<p><code>[selene.name]</code> - Used for specifying the name of the standard library. Used internally for cases such as only giving Roblox lints if the standard library is named <code>&quot;roblox&quot;</code>.</p>
<p><code>[selene.structs]</code> - Used for declaring <a href="cli/std.html#structs">structs</a>.</p>
<h2><a class="header" href="#globals" id="globals">[globals]</a></h2>
<p>This is where the magic happens. The <code>globals</code> field is a dictionary where the keys are the globals you want to define. The value you give tells selene what the value can be, do, and provide.</p>
<p>If your standard library is based off another, overriding something defined there will use your implementation over the original.</p>
<h2><a class="header" href="#any" id="any">Any</a></h2>
<p>Example:</p>
<pre><code class="language-toml">[foo]
any = true
</code></pre>
<p>Specifies that the field can be used in any possible way, meaning that <code>foo.x</code>, <code>foo:y()</code>, etc will all validate.</p>
<h2><a class="header" href="#functions" id="functions">Functions</a></h2>
<p>Example:</p>
<pre><code class="language-toml">[[tonumber.args]]
type = &quot;any&quot;

[[tonumber.args]]
type = &quot;number&quot;
required = false
</code></pre>
<p>A field is a function if it contains an <code>args</code> and/or <code>method</code> field.</p>
<p>If <code>method</code> is specified as <code>true</code> and the function is inside a table, then it will require the function be called in the form of <code>Table:FunctionName()</code>, instead of <code>Table.FunctionName()</code>.</p>
<p><code>args</code> is an array of arguments, in order of how they're used in the function. An argument is in the form of:</p>
<pre><code>required?: false | true | string;
type: &quot;any&quot; | &quot;bool&quot; | &quot;function&quot; | &quot;nil&quot;
    | &quot;number&quot; | &quot;string&quot; | &quot;table&quot; | &quot;...&quot;
    | string[] | { &quot;display&quot;: string }
</code></pre>
<h2><a class="header" href="#required" id="required">&quot;required&quot;</a></h2>
<ul>
<li><code>true</code> - The default, this argument is required.</li>
<li><code>false</code> - This argument is optional.</li>
<li>A string - This argument is required, and not using it will give this as the reason why.</li>
</ul>
<h2><a class="header" href="#argument-types" id="argument-types">Argument types</a></h2>
<ul>
<li><code>&quot;any&quot;</code> - Allows any value.</li>
<li><code>&quot;bool&quot;</code>, <code>&quot;function&quot;</code>, <code>&quot;nil&quot;</code>, <code>&quot;number&quot;</code>, <code>&quot;string&quot;</code>, <code>&quot;table&quot;</code> - Expects a value of the respective type.</li>
<li><code>&quot;...&quot;</code> - Allows any number of variables after this one. If <code>required</code> is true (it is by default), then this will lint if no additional arguments are given. It is incorrect to have this in the middle.</li>
<li>Constant list of strings - Will check if the value provided is one of the strings in the list. For example, <code>collectgarbage</code> only takes one of a few exact string arguments--doing <code>collectgarbage(&quot;count&quot;)</code> will work, but <code>collectgarbage(&quot;whoops&quot;)</code> won't.</li>
<li><code>{ &quot;display&quot;: string }</code> - Used when no constant could possibly be correct. If a constant is used, selene will tell the user that an argument of the type (display) is required. For an example, the Roblox method <code>Color3.toHSV</code> expects a <code>Color3</code> object--no constant inside it could be correct, so this is defined as:</li>
</ul>
<pre><code class="language-toml">[[Color3.toHSV.args]]
type = { display = &quot;Color3&quot; }
</code></pre>
<h2><a class="header" href="#properties" id="properties">Properties</a></h2>
<p>Example:</p>
<pre><code class="language-toml">[_VERSION]
property = true
</code></pre>
<p>Specifies that a property exists. For example, <code>_VERSION</code> is available as a global and doesn't have any fields of its own, so it is just defined as a property.</p>
<p>The same goes for <code>_G</code>, which is defined as:</p>
<pre><code class="language-toml">[_G]
property = true
writable = &quot;new-fields&quot;
</code></pre>
<p><code>writable</code> is an optional field that tells selene how the property can be mutated and used:</p>
<ul>
<li><code>&quot;new-fields&quot;</code> - New fields can be added and set, but variable itself cannot be redefined. In the case of _G, it means that <code>_G = &quot;foo&quot;</code> is linted against.</li>
<li><code>&quot;overridden&quot;</code> - New fields can't be added, but entire variable can be overridden. In the case of Roblox's <code>Instance.Name</code>, it means we can do <code>Instance.Name = &quot;Hello&quot;</code>, but not <code>Instance.Name.Call()</code>.</li>
<li><code>&quot;full&quot;</code> - New fields can be added and entire variable can be overridden.</li>
</ul>
<p>If <code>writable</code> is not specified, selene will assume it can neither have new fields associated with it nor can be overridden.</p>
<h2><a class="header" href="#struct" id="struct">Struct</a></h2>
<p>Example:</p>
<pre><code class="language-toml">[game]
struct = &quot;DataModel&quot;
</code></pre>
<p>Specifies that the field is an instance of a <a href="cli/std.html#structs">struct</a>. The value is the name of the struct.</p>
<h2><a class="header" href="#table" id="table">Table</a></h2>
<p>Example:</p>
<pre><code class="language-toml">[math.huge]
property = true

[math.pi]
property = true
</code></pre>
<p>A field is understood as a table if it has fields of its own. Notice that <code>[math]</code> is not defined anywhere, but its fields are. Fields are of the same type as globals.</p>
<h2><a class="header" href="#removed" id="removed">Removed</a></h2>
<p>Example:</p>
<pre><code class="language-toml">[getfenv]
removed = true
</code></pre>
<p>Used when your standard library is based off another, and your library removes something from the original.</p>
<h1><a class="header" href="#structs" id="structs">Structs</a></h1>
<p>Structs are used in places such as Roblox Instances. Every Instance in Roblox, for example, declares a <code>:GetChildren()</code> method. We don't want to have to define this everywhere an Instance is declared globally, so instead we just define it once in a struct.</p>
<p>Structs are defined as fields of <code>[selene.structs]</code>. Any fields they have will be used for instances of that struct. For example, the Roblox standard library has the struct:</p>
<pre><code class="language-toml">[selene.structs.Event.Connect]
method = true

[[selene.structs.Event.Connect.args]]
type = &quot;function&quot;
</code></pre>
<p>From there, it can define:</p>
<pre><code class="language-toml">[workspace.Changed]
struct = &quot;Event&quot;
</code></pre>
<p>...and selene will know that <code>workspace.Changed:Connect(callback)</code> is valid, but <code>workspace.Changed:RandomNameHere()</code> is not.</p>
<h1><a class="header" href="#wildcards" id="wildcards">Wildcards</a></h1>
<p>Fields can specify requirements if a field is referenced that is not explicitly named. For example, in Roblox, instances can have arbitrary fields of other instances (<code>workspace.Baseplate</code> indexes an instance named Baseplate inside <code>workspace</code>, but <code>Baseplate</code> is nowhere in the Roblox API).</p>
<p>We can specify this behavior by using the special <code>&quot;*&quot;</code> field.</p>
<pre><code class="language-toml">[workspace.&quot;*&quot;]
struct = &quot;Instance&quot;
</code></pre>
<p>This will tell selene &quot;any field accessed from <code>workspace</code> that doesn't exist must be an Instance <a href="cli/std.html#structs">struct</a>&quot;.</p>
<p>Wildcards can even be used in succession. For example, consider the following:</p>
<pre><code class="language-toml">[script.Name]
property = true
writable = &quot;overridden&quot;

[script.&quot;*&quot;.&quot;*&quot;]
property = true
writable = &quot;full&quot;
</code></pre>
<p>Ignoring the wildcard, so far this means:</p>
<ul>
<li><code>script.Name = &quot;Hello&quot;</code> <em>will</em> work.</li>
<li><code>script = nil</code> <em>will not</em> work, because the writability of <code>script</code> is not specified.</li>
<li><code>script.Name.UhOh</code> <em>will not</em> work, because <code>script.Name</code> does not have fields.</li>
</ul>
<p>However, with the wildcard, this adds extra meaning:</p>
<ul>
<li><code>script.Foo = 3</code> <em>will not</em> work, because the writability of <code>script.*</code> is not specified.</li>
<li><code>script.Foo.Bar = 3</code> <em>will</em> work, because <code>script.*.*</code> has full writability.</li>
<li><code>script.Foo.Bar.Baz = 3</code> <em>will</em> work for the same reason as above.</li>
</ul>
<h1><a class="header" href="#contributing" id="contributing">Contributing</a></h1>
<p>selene is written in Rust, so knowledge of the ecosystem is expected.</p>
<p>selene uses <a href="https://github.com/Kampfkarren/full-moon">Full Moon</a> to parse the Lua code losslessly, meaning whitespace and comments are preserved. You can read the full documentation for Full Moon on its <a href="https://docs.rs/full_moon/latest/full_moon/">docs.rs</a> page.</p>
<p>TODO: Upload selene-lib on crates.io and link the docs.rs page for that as well as throughout the rest of this article.</p>
<h2><a class="header" href="#writing-a-lint" id="writing-a-lint">Writing a lint</a></h2>
<p>In selene, lints are created in isolated modules. To start, create a file in <code>selene-lib/src/rules</code> with the name of your lint. In this example, we're going to call the lint <code>cool_lint.rs</code>.</p>
<p>Let's now understand what a lint consists of. selene takes lints in the form of structs that implement the <code>Rule</code> trait. The <code>Rule</code> trait expects:</p>
<ul>
<li>A <code>Config</code> associated type that defines what the configuration format is expected to be. Whatever you pass must be <a href="https://serde.rs/">deserializable</a>.</li>
<li>An <code>Error</code> associated type that implements <a href="https://doc.rust-lang.org/std/error/trait.Error.html"><code>std::error::Error</code></a>. This is used if configurations can be invalid (such as a parameter only being a number within a range). Most of the time, configurations cannot be invalid (other than deserializing errors, which are handled by selene), and so you can set this to <a href="https://doc.rust-lang.org/std/convert/enum.Infallible.html"><code>std::convert::Infallible</code></a>.</li>
<li>A <code>new</code> function with the signature <code>fn new(config: Self::Config) -&gt; Result&lt;Self, Self::Error&gt;</code>. With the selene CLI, this is called once.</li>
<li>A <code>pass</code> function with the signature <code>fn pass(&amp;self, ast: &amp;full_moon::ast::Ast&lt;'static&gt;, context: &amp;Context) -&gt; Vec&lt;Diagnostic&gt;</code>. The <code>ast</code> argument is the Full Moon representation of the code, and the context provides optional additional information, such as the standard library being used. Any <code>Diagnostic</code> structs returned here are displayed to the user.</li>
<li>A <code>severity</code> function with the signature <code>fn severity(&amp;self) -&gt; Severity</code>. Returns either <code>Severity::Error</code> or <code>Severity::Warning</code>. Use <code>Error</code> if the code is positively impossible to be correct. The <code>&amp;self</code> is only provided due to limitations of Rust--the function should be completely constant and pure.</li>
<li>A <code>rule_type</code> function with the signature <code>fn rule_type(&amp;self) -&gt; RuleType</code>. Returns either <code>Complexity</code>, <code>Correctness</code>, <code>Performance</code>, or <code>Style</code>. So far not used for anything. Has the same gotcha as <code>severity</code> in relation to <code>&amp;self</code>.</li>
</ul>
<p>For our purposes, we're going to write:</p>
<pre><code class="language-rs">use super::*;
use std::convert::Infallible;

struct CoolLint;

impl Rule for CoolLint {
    type Config = ();
    type Error = Infallible;

    fn new(_: Self::Config) -&gt; Result&lt;Self, Self::Error&gt; {
        Ok(CoolLint)
    }

    fn pass(&amp;self, ast: &amp;Ast, _: &amp;Context) -&gt; Vec&lt;Diagnostic&gt; {
        unimplemented!()
    }

    fn severity(&amp;self) -&gt; Severity {
        Severity::Warning
    }

    fn rule_type(&amp;self) -&gt; RuleType {
        RuleType::Style
    }
}
</code></pre>
<p>The implementation of <code>pass</code> is completely up to you, but there are a few common patterns.</p>
<ul>
<li>Creating a visitor over the ast provided and creating diagnostics based off of that. See <a href="https://github.com/Kampfkarren/selene/blob/master/selene-lib/src/rules/divide_by_zero.rs"><code>divide_by_zero</code></a> and <a href="https://github.com/Kampfkarren/selene/blob/master/selene-lib/src/rules/suspicious_reverse_loop.rs"><code>suspicious_reverse_loop</code></a> for straight forward examples.</li>
<li>Using the <code>ScopeManager</code> struct to lint based off of usage of variables and references. See <a href="https://github.com/Kampfkarren/selene/blob/master/selene-lib/src/rules/shadowing.rs"><code>shadowing</code></a> and <a href="https://github.com/Kampfkarren/selene/blob/master/selene-lib/src/rules/global_usage.rs"><code>global_usage</code></a>.</li>
</ul>
<h3><a class="header" href="#getting-selene-to-recognize-the-new-lint" id="getting-selene-to-recognize-the-new-lint">Getting selene to recognize the new lint</a></h3>
<p>Now that we have our lint, we have to make sure selene actually knows to use it. There are two places you need to update.</p>
<p>In selene-lib/src/lib.rs, search for <code>use_rules!</code>. You will see something such as:</p>
<pre><code class="language-rs">use_rules! {
    almost_swapped: rules::almost_swapped::AlmostSwappedLint,
    divide_by_zero: rules::divide_by_zero::DivideByZeroLint,
    empty_if: rules::empty_if::EmptyIfLint,
    ...
}
</code></pre>
<p>Put your lint in this lint (alphabetical order) as the following format:</p>
<pre><code>lint_name: rules::module_name::LintObject,
</code></pre>
<p>For us, this would be:</p>
<pre><code>cool_lint: rules::cool_lint::CoolLint,
</code></pre>
<p>Next, in <code>selene-lib/src/rules.rs</code>, search for <code>pub mod</code>, and you will see:</p>
<pre><code class="language-rs">pub mod almost_swapped;
pub mod divide_by_zero;
pub mod empty_if;
...
</code></pre>
<p>Put your module name in this list, also in alphabetical order.</p>
<pre><code class="language-rs">pub mod almost_swapped;
pub mod cool_lint;
pub mod divide_by_zero;
pub mod empty_if;
...
</code></pre>
<p>And we're done! You should be able to <code>cargo build --bin selene</code> and be able to use your new lint.</p>
<h3><a class="header" href="#writing-tests" id="writing-tests">Writing tests</a></h3>
<p>The selene codebase uses tests extensively for lints. It means we never have to actually build the CLI tool in order to test, and we can make sure we don't have any regressions. <strong>Testing is required if you want to submit your lint to the selene codebase.</strong></p>
<p>To write a simple test, create a folder in <code>selene-lib/tests</code> with the name of your lint. Then, create as many <code>.lua</code> files as you want to test. These should contain both cases that do and do not lint. For our cases, we're going to assume our test is called <code>cool_lint.lua</code>.</p>
<p>Then, in your lint module, add at the bottom:</p>
<pre><code class="language-rs">#[cfg(test)]
mod tests {
    use super::{super::test_util::test_lint, *};

    #[test]
    fn test_cool_lint() {
        test_lint(
            CoolLint::new(()).unwrap(),
            &quot;cool_lint&quot;,
            &quot;cool_lint&quot;,
        );
    }
}
</code></pre>
<p>Let's discuss what this code means, assuming you're familiar with <a href="https://doc.rust-lang.org/book/ch11-00-testing.html">the way tests are written and performed in Rust</a>.</p>
<p>The <code>test_lint</code> function is the easiest way to test that a lint works. It'll search the source code we made before, run selene on it (only your lint), and check its results with the existing <code>[filename].stderr</code> file, or create one if it does not yet exist.</p>
<p>The first argument is the lint object to use. <code>CoolLint::new(())</code> just means &quot;create <code>CoolLint</code> with a configuration of <code>()</code>&quot;. If your lint specifies a configuration, this will instead be something such as <code>CoolLintConfig::default()</code> or whatever you're specifically testing.</p>
<p>The <code>.unwrap()</code> is just because <code>CoolLint::new</code> returns a <code>Result</code>. If you want to test configuration errors, you can avoid <code>test_lint</code> altogether and just test <code>CoolLint::new(...).is_err()</code> directly.</p>
<p>The first <code>&quot;cool_lint&quot;</code> is the name of the folder we created. The second <code>&quot;cool_lint&quot;</code> is the name of the <em>Lua file</em> we created.</p>
<p>Now, just run <code>cargo test</code>, and a <code>.stderr</code> file will be automatically generated! You can manipulate it however you see fit as well as modifying your rule, and so long as the file is there, selene will make sure that its accurate.</p>
<p>Optionally, you can add a <code>.std.toml</code> with the same name as the test next to the lua file, where you can specify a custom <a href="./cli/std.html">standard library</a> to use. If you do not, the Lua 5.1 standard library will be used.</p>
<h3><a class="header" href="#documenting-it" id="documenting-it">Documenting it</a></h3>
<p>This step is only if you are contributing to the selene codebase, and not just writing personal lints (though I'm sure your other programmers would love if you did this).</p>
<p>To document a new lint, edit <code>docs/src/SUMMARY.md</code>, and add your lint to the table of contents along the rest. As with everything else, make sure it's in alphabetical order.</p>
<p>Then, edit the markdown file it creates (if you have <code>mdbook serve</code> on, it'll create it for you), and write it in this format:</p>
<pre><code># rule_name
## What it does
Explain what your lint does, simply.

## Why this is bad
Explain why a user would want to lint this.

## Configuration
Specify any configuration if it exists.

## Example
```lua
-- Bad code here
```

...should be written as...

```lua
-- Good code here
```

## Remarks
If there's anything else a user should know when using this lint, write it here.
</code></pre>
<p>This isn't a strict format, and you can mess with it as appropriate. For example, <code>standard_library</code> does not have a &quot;Why this is bad&quot; section as not only is it a very encompassing rule, but it should be fairly obvious. Many rules don't specify a &quot;...should be written as...&quot; as it is either something with various potential fixes (such as <a href="./lints/global_usage.html"><code>global_usage</code></a>) or because the &quot;good code&quot; is just removing parts entirely (such as <a href="./lints/unbalanced_assignments.html"><code>unbalanced_assignments</code></a>).</p>
<h1><a class="header" href="#lints" id="lints">Lints</a></h1>
<p>The following is the list of lints that selene will check for in your code.</p>
<h1><a class="header" href="#almost_swapped" id="almost_swapped">almost_swapped</a></h1>
<h2><a class="header" href="#what-it-does" id="what-it-does">What it does</a></h2>
<p>Checks for <code>foo = bar; bar = foo</code> sequences.</p>
<h2><a class="header" href="#why-this-is-bad" id="why-this-is-bad">Why this is bad</a></h2>
<p>This looks like a failed attempt to swap.</p>
<h2><a class="header" href="#example" id="example">Example</a></h2>
<pre><code class="language-lua">a = b
b = a
</code></pre>
<p>...should be written as...</p>
<pre><code class="language-lua">a, b = b, a
</code></pre>
<h1><a class="header" href="#divide_by_zero" id="divide_by_zero">divide_by_zero</a></h1>
<h2><a class="header" href="#what-it-does-1" id="what-it-does-1">What it does</a></h2>
<p>Checks for division by zero. Allows <code>0 / 0</code> as a way to get <a href="https://en.wikipedia.org/wiki/NaN">nan</a>.</p>
<h2><a class="header" href="#why-this-is-bad-1" id="why-this-is-bad-1">Why this is bad</a></h2>
<p><code>n / 0</code> equals <code>math.huge</code> when n is positive, and <code>-math.huge</code> when n is negative. Use these values directly instead, as using the <code>/ 0</code> way is confusing to read and non-idiomatic.</p>
<h2><a class="header" href="#example-1" id="example-1">Example</a></h2>
<pre><code class="language-lua">print(1 / 0)
print(-1 / 0)
</code></pre>
<p>...should be written as...</p>
<pre><code class="language-lua">print(math.huge)
print(-math.huge)
</code></pre>
<h1><a class="header" href="#empty_if" id="empty_if">empty_if</a></h1>
<h2><a class="header" href="#what-it-does-2" id="what-it-does-2">What it does</a></h2>
<p>Checks for empty if blocks.</p>
<h2><a class="header" href="#why-this-is-bad-2" id="why-this-is-bad-2">Why this is bad</a></h2>
<p>You most likely forgot to write code in there or commented it out without commenting out the if statement itself.</p>
<h2><a class="header" href="#configuration-1" id="configuration-1">Configuration</a></h2>
<p><code>comments_count</code> (default: <code>false</code>) - A bool that determines whether or not if statements with exclusively comments are empty.</p>
<h2><a class="header" href="#example-2" id="example-2">Example</a></h2>
<pre><code class="language-lua">-- Each of these branches count as an empty if.
if a then
elseif b then
else
end

if a then
    -- If comments_count is true, this will not count as empty.
end
</code></pre>
<h1><a class="header" href="#global_usage" id="global_usage">global_usage</a></h1>
<h2><a class="header" href="#what-it-does-3" id="what-it-does-3">What it does</a></h2>
<p>Prohibits use of <code>_G</code>.</p>
<h2><a class="header" href="#why-this-is-bad-3" id="why-this-is-bad-3">Why this is bad</a></h2>
<p><code>_G</code> is global mutable state, which is heavily regarded as harmful. You should instead refactor your code to be more modular in nature.</p>
<h2><a class="header" href="#remarks" id="remarks">Remarks</a></h2>
<p>If you are using the Roblox standard library, use of <code>shared</code> is prohibited under this rule.</p>
<h2><a class="header" href="#example-3" id="example-3">Example</a></h2>
<pre><code class="language-lua">_G.foo = 1
</code></pre>
<h1><a class="header" href="#if_same_then_else" id="if_same_then_else">if_same_then_else</a></h1>
<h2><a class="header" href="#what-it-does-4" id="what-it-does-4">What it does</a></h2>
<p>Checks for branches in if blocks that are equivalent.</p>
<h2><a class="header" href="#why-this-is-bad-4" id="why-this-is-bad-4">Why this is bad</a></h2>
<p>This is most likely a copy and paste error.</p>
<h2><a class="header" href="#example-4" id="example-4">Example</a></h2>
<pre><code class="language-lua">if foo then
    print(1)
else
    print(1)
end
</code></pre>
<h1><a class="header" href="#ifs_same_cond" id="ifs_same_cond">ifs_same_cond</a></h1>
<h2><a class="header" href="#what-it-does-5" id="what-it-does-5">What it does</a></h2>
<p>Checks for branches in if blocks with equivalent conditions.</p>
<h2><a class="header" href="#why-this-is-bad-5" id="why-this-is-bad-5">Why this is bad</a></h2>
<p>This is most likely a copy and paste error.</p>
<h2><a class="header" href="#example-5" id="example-5">Example</a></h2>
<pre><code class="language-lua">if foo then
    print(1)
elseif foo then
    print(1)
then
</code></pre>
<h2><a class="header" href="#remarks-1" id="remarks-1">Remarks</a></h2>
<p>This ignores conditions that could have side effects, such as function calls. This will not lint:</p>
<pre><code class="language-lua">if foo() then
    print(1)
elseif foo() then
    print(1)
then
</code></pre>
<p>...as the result of <code>foo()</code> could be different the second time it is called.</p>
<h1><a class="header" href="#multiple_statements" id="multiple_statements">multiple_statements</a></h1>
<h2><a class="header" href="#what-it-does-6" id="what-it-does-6">What it does</a></h2>
<p>Checks for multiple statements on the same line.</p>
<h2><a class="header" href="#why-this-is-bad-6" id="why-this-is-bad-6">Why this is bad</a></h2>
<p>This can make your code difficult to read.</p>
<h2><a class="header" href="#configuration-2" id="configuration-2">Configuration</a></h2>
<p><code>one_line_if</code> (default: <code>&quot;break-return-only&quot;</code>) - Defines whether or not one line if statements should be allowed. One of three options:</p>
<ul>
<li>&quot;break-return-only&quot; (default) - <code>if x then return end</code> or <code>if x then break end</code> is ok, but <code>if x then call() end</code> is not.</li>
<li>&quot;allow&quot; - All one line if statements are allowed.</li>
<li>&quot;deny&quot; - No one line if statements are allowed.</li>
</ul>
<h2><a class="header" href="#example-6" id="example-6">Example</a></h2>
<pre><code class="language-lua">foo() bar() baz()
</code></pre>
<p>...should be written as...</p>
<pre><code class="language-lua">foo()
bar()
baz()
</code></pre>
<h1><a class="header" href="#parenthese_conditions" id="parenthese_conditions">parenthese_conditions</a></h1>
<h2><a class="header" href="#what-it-does-7" id="what-it-does-7">What it does</a></h2>
<p>Checks for conditions in the form of <code>(expression)</code>.</p>
<h2><a class="header" href="#why-this-is-bad-7" id="why-this-is-bad-7">Why this is bad</a></h2>
<p>Lua does not require these, and they are not idiomatic.</p>
<h2><a class="header" href="#example-7" id="example-7">Example</a></h2>
<pre><code class="language-lua">if (x) then
repeat until (x)
while (x) do
</code></pre>
<p>...should be written as...</p>
<pre><code class="language-lua">if x then
repeat until x
while x do
</code></pre>
<h1><a class="header" href="#shadowing" id="shadowing">shadowing</a></h1>
<h2><a class="header" href="#what-it-does-8" id="what-it-does-8">What it does</a></h2>
<p>Checks for overriding of variables under the same name.</p>
<h2><a class="header" href="#why-this-is-bad-8" id="why-this-is-bad-8">Why this is bad</a></h2>
<p>This can cause confusion when reading the code when trying to understand which variable is being used, and if you want to use the original variable you either have to redefine it under a temporary name or refactor the code that shadowed it.</p>
<h2><a class="header" href="#configuration-3" id="configuration-3">Configuration</a></h2>
<p><code>ignore_pattern</code> (default: <code>&quot;^_&quot;</code>) - A <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expression</a> that is used to specify names that are allowed to be shadowed. The default allows for variables like <code>_</code> to be shadowed, as they shouldn't be used anyway.</p>
<h2><a class="header" href="#example-8" id="example-8">Example</a></h2>
<pre><code class="language-lua">local x = 1

if foo then
    local x = 1
end
</code></pre>
<h1><a class="header" href="#standard_library" id="standard_library">standard_library</a></h1>
<h2><a class="header" href="#what-it-does-9" id="what-it-does-9">What it does</a></h2>
<p>Checks for correct use of <a href="lints/../cli/std.html">the standard library</a>.</p>
<h2><a class="header" href="#example-9" id="example-9">Example</a></h2>
<pre><code class="language-lua">for _, shop in pairs(GoldShop, ItemShop, MedicineShop) do
</code></pre>
<h2><a class="header" href="#remarks-2" id="remarks-2">Remarks</a></h2>
<p><strong>It is highly recommended that you do not turn this lint off.</strong> If you are having standard library issues, modify your standard library instead to be correct. If it is a problem with an official standard library (Ex: the Lua 5.1 or Roblox ones), you can file an <a href="https://github.com/Kampfkarren/selene/issues">issue on GitHub</a>.</p>
<h1><a class="header" href="#suspicious_reverse_loop" id="suspicious_reverse_loop">suspicious_reverse_loop</a></h1>
<h2><a class="header" href="#what-it-does-10" id="what-it-does-10">What it does</a></h2>
<p>Checks for <code>for _ = #x, 1 do</code> sequences without specifying a negative step.</p>
<h2><a class="header" href="#why-this-is-bad-9" id="why-this-is-bad-9">Why this is bad</a></h2>
<p>This loop will only run at most once, instead of going in reverse. If you truly did mean to run your loop only once, just use <code>if #x &gt; 0</code> instead.</p>
<h2><a class="header" href="#example-10" id="example-10">Example</a></h2>
<pre><code class="language-lua">for _ = #x, 1 do
</code></pre>
<p>...should be written as...</p>
<pre><code class="language-lua">for _ = #x, 1, -1 do
</code></pre>
<h1><a class="header" href="#unbalanced_assignments" id="unbalanced_assignments">unbalanced_assignments</a></h1>
<h2><a class="header" href="#what-it-does-11" id="what-it-does-11">What it does</a></h2>
<p>Checks for unbalanced assignments, such as <code>a, b, c = 1</code>.</p>
<h2><a class="header" href="#why-this-is-bad-10" id="why-this-is-bad-10">Why this is bad</a></h2>
<p>You shouldn't declare variables you're not immediately initializing on the same line as ones you are. This is most likely just forgetting to specify the rest of the variables.</p>
<h2><a class="header" href="#example-11" id="example-11">Example</a></h2>
<pre><code class="language-lua">a, b, c = 1
a = 1, 2
</code></pre>
<h2><a class="header" href="#remarks-3" id="remarks-3">Remarks</a></h2>
<p>There are a few things this lint won't catch.</p>
<p><code>a, b, c = call()</code> will not lint, as <code>call()</code> could return multiple values.</p>
<p><code>a, b, c = call(), 2</code> will, however, as you will only be using the first value of <code>call()</code>. You will even receive a helpful message about this.</p>
<pre><code>error[unbalanced_assignments]: values on right side don't match up to the left side of the assignment

   ┌── unbalanced_assignments.lua:6:11 ───
   │
 6 │ a, b, c = call(), 2
   │           ^^^^^^^^^
   │

   ┌── unbalanced_assignments.lua:6:11 ───
   │
 6 │ a, b, c = call(), 2
   │           ------ help: if this function returns more than one value, the only first return value is actually used
   │
</code></pre>
<p>If nil is specified as the last value, the rest will be ignored. This means...</p>
<pre><code class="language-lua">a, b, c = nil
</code></pre>
<p>...will not lint.</p>
<h1><a class="header" href="#undefined_variable" id="undefined_variable">undefined_variable</a></h1>
<h2><a class="header" href="#what-it-does-12" id="what-it-does-12">What it does</a></h2>
<p>Checks for uses of variables that are not defined.</p>
<h2><a class="header" href="#why-this-is-bad-11" id="why-this-is-bad-11">Why this is bad</a></h2>
<p>This is most likely a typo.</p>
<h2><a class="header" href="#example-12" id="example-12">Example</a></h2>
<pre><code class="language-lua">-- vv oops!
prinnt(&quot;hello, world!&quot;)
</code></pre>
<h2><a class="header" href="#remarks-4" id="remarks-4">Remarks</a></h2>
<p>If you are using a different standard library where a global variable is defined that selene isn't picking up on, create a <a href="lints/../cli/std.html">standard library</a> that specifies it.</p>
<h1><a class="header" href="#unused_variable" id="unused_variable">unused_variable</a></h1>
<h2><a class="header" href="#what-it-does-13" id="what-it-does-13">What it does</a></h2>
<p>Checks for variables that are unused.</p>
<h2><a class="header" href="#why-this-is-bad-12" id="why-this-is-bad-12">Why this is bad</a></h2>
<p>The existence of unused variables could indicate buggy code.</p>
<h2><a class="header" href="#configuration-4" id="configuration-4">Configuration</a></h2>
<p><code>allow_unused_self</code> (default: <code>false</code>) - A bool that determines whether not using <code>self</code> in a method function (<code>function Player:SwapWeapons()</code>) is allowed.</p>
<p><code>ignore_pattern</code> (default: <code>&quot;^_&quot;</code>) - A <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expression</a> for variables that are allowed to be unused. The default allows for variables like <code>_</code> to be unused, as they shouldn't be used anyway.</p>
<h2><a class="header" href="#example-13" id="example-13">Example</a></h2>
<pre><code class="language-lua">local foo = 1
</code></pre>
<h2><a class="header" href="#remarks-5" id="remarks-5">Remarks</a></h2>
<p>If you intend to create a variable without using it, replace it with <code>_</code> or something that starts with <code>_</code>. You'll see this most in generic for loops.</p>
<pre><code class="language-lua">for _, value in ipairs(list) do
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
